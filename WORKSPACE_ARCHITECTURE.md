# ðŸ—ï¸ Workspace - ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð°

## ÐžÐ±Ñ‰Ð°Ñ ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     React Frontend                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Workspace Pages       Kanban Board      Components      â”‚
â”‚  - Auth               - Drag & Drop      - Types        â”‚
â”‚  - Dashboard          - Columns          - Hooks        â”‚
â”‚  - Project            - Tasks                           â”‚
â”‚  - Settings                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              Framer Motion Animations                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  React Router v6                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              Supabase Client Library                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   Supabase Cloud                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚        PostgreSQL Database                        â”‚  â”‚
â”‚  â”‚  - workspace_projects                            â”‚  â”‚
â”‚  â”‚  - team_members                                  â”‚  â”‚
â”‚  â”‚  - boards                                        â”‚  â”‚
â”‚  â”‚  - board_columns                                 â”‚  â”‚
â”‚  â”‚  - tasks                                         â”‚  â”‚
â”‚  â”‚  - Row Level Security                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚        Supabase Auth                             â”‚  â”‚
â”‚  â”‚  - Email/Password                               â”‚  â”‚
â”‚  â”‚  - Session Management                           â”‚  â”‚
â”‚  â”‚  - JWT Tokens                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° ÐŸÐ°Ð¿Ð¾Ðº

```
src/
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ Workspace.tsx
â”‚   â”‚   â”œâ”€â”€ State: projects[], user, modals
â”‚   â”‚   â”œâ”€â”€ Functions: createProject, loadProjects
â”‚   â”‚   â””â”€â”€ UI: Header, Project Grid, Modal
â”‚   â”‚
â”‚   â”œâ”€â”€ WorkspaceAuth.tsx
â”‚   â”‚   â”œâ”€â”€ State: email, password, loading, error
â”‚   â”‚   â”œâ”€â”€ Functions: handleAuth, toggle mode
â”‚   â”‚   â””â”€â”€ UI: Form, Toggle Link, Error Message
â”‚   â”‚
â”‚   â”œâ”€â”€ WorkspaceProject.tsx
â”‚   â”‚   â”œâ”€â”€ State: project, boards, selectedBoard, members
â”‚   â”‚   â”œâ”€â”€ Functions: createBoard, inviteMember, deleteBoard
â”‚   â”‚   â””â”€â”€ UI: Header, Board Tabs, Kanban
â”‚   â”‚
â”‚   â””â”€â”€ WorkspaceSettings.tsx
â”‚       â”œâ”€â”€ State: user
â”‚       â”œâ”€â”€ Functions: handleLogout
â”‚       â””â”€â”€ UI: Account Info, Danger Zone
â”‚
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ KanbanBoard.tsx
â”‚   â”‚   â”œâ”€â”€ State: columns[], tasks[], draggedTask
â”‚   â”‚   â”œâ”€â”€ Functions: createTask, updateStatus, deleteTask, toggleComplete
â”‚   â”‚   â””â”€â”€ UI: Columns, Tasks, Drag & Drop
â”‚   â”‚
â”‚   â””â”€â”€ (Ð´Ñ€ÑƒÐ³Ð¸Ñ… ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ð¾Ð² Ð±ÑƒÐ´ÑƒÑ‚ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ñ‹)
â”‚
â”œâ”€â”€ types/
â”‚   â””â”€â”€ workspace.ts
â”‚       â”œâ”€â”€ WorkspaceUser
â”‚       â”œâ”€â”€ WorkspaceProject
â”‚       â”œâ”€â”€ TeamMember
â”‚       â”œâ”€â”€ Board
â”‚       â”œâ”€â”€ BoardColumn
â”‚       â””â”€â”€ Task
â”‚
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ supabase.ts (ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚)
â”‚
â”œâ”€â”€ context/
â”‚   â””â”€â”€ (Ð¼Ð¾Ð¶Ð½Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ AppContext Ð´Ð»Ñ Workspace)
â”‚
â””â”€â”€ App.tsx
    â”œâ”€â”€ Routes Ð´Ð»Ñ workspace
    â”œâ”€â”€ Error handling
    â””â”€â”€ Providers
```

---

## Data Flow

### 1. ÐÐ²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ
```
User Input â†’ WorkspaceAuth Component
    â†“
supabase.auth.signUp/signInWithPassword()
    â†“
Supabase Auth Service
    â†“
Session Created
    â†“
Redirect to /workspace
```

### 2. Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° ÐŸÑ€Ð¾ÐµÐºÑ‚Ð¾Ð²
```
Workspace Component Mounted
    â†“
useEffect() â†’ checkAuth()
    â†“
Supabase Query: workspace_projects (user_id = current_user)
    â†“
Set State: projects[]
    â†“
Render Project Grid
```

### 3. Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð—Ð°Ð´Ð°Ñ‡Ð¸
```
User Click "Add task"
    â†“
Show Input Modal
    â†“
User Input Title
    â†“
KanbanBoard.createTask()
    â†“
supabase.from("tasks").insert()
    â†“
Supabase Insert
    â†“
Set State: tasks[]
    â†“
Re-render Column with New Task
```

### 4. Drag & Drop Ð—Ð°Ð´Ð°Ñ‡Ð¸
```
Mouse Down on Task Card
    â†“
setDraggedTask(task)
    â†“
Drag Over Column
    â†“
Highlight Drop Zone
    â†“
Mouse Up
    â†“
KanbanBoard.updateTaskStatus()
    â†“
supabase.from("tasks").update({ column_id: newColumnId })
    â†“
Set State: tasks updated
    â†“
Re-render
```

---

## Component Hierarchy

```
App
â”œâ”€â”€ Route: /workspace-auth
â”‚   â””â”€â”€ WorkspaceAuth
â”‚
â”œâ”€â”€ Route: /workspace
â”‚   â””â”€â”€ Workspace
â”‚       â”œâ”€â”€ Header
â”‚       â”œâ”€â”€ Create Project Modal
â”‚       â””â”€â”€ Project Grid
â”‚           â””â”€â”€ Project Card (Repeating)
â”‚
â”œâ”€â”€ Route: /workspace/project/:id
â”‚   â””â”€â”€ WorkspaceProject
â”‚       â”œâ”€â”€ Header
â”‚       â”‚   â”œâ”€â”€ Back Button
â”‚       â”‚   â”œâ”€â”€ Invite Button
â”‚       â”‚   â””â”€â”€ Settings Button
â”‚       â”œâ”€â”€ Create Board Modal
â”‚       â”œâ”€â”€ Board Tabs
â”‚       â”‚   â””â”€â”€ Board Tab (Repeating)
â”‚       â””â”€â”€ Kanban Board (Content)
â”‚           â”œâ”€â”€ Column (x4)
â”‚           â”‚   â”œâ”€â”€ Column Header
â”‚           â”‚   â”œâ”€â”€ Task Cards
â”‚           â”‚   â”‚   â””â”€â”€ Task (Draggable, Repeating)
â”‚           â”‚   â””â”€â”€ Add Task Button
â”‚           â””â”€â”€ Add New Column
â”‚
â””â”€â”€ Route: /workspace/settings
    â””â”€â”€ WorkspaceSettings
        â”œâ”€â”€ Header
        â”œâ”€â”€ Account Info Section
        â””â”€â”€ Danger Zone Section
```

---

## State Management

### Global State (Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½)
```typescript
// Context Ð´Ð»Ñ Workspace
interface WorkspaceContextType {
  currentUser: WorkspaceUser | null;
  currentProject: WorkspaceProject | null;
  currentBoard: Board | null;
  loadingProject: boolean;
  error: string | null;
}
```

### Local State (Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹ Ð¿Ð¾Ð´Ñ…Ð¾Ð´)
```typescript
// Each component manages its own state
- Workspace: projects, user, modals
- WorkspaceProject: project, boards, members, modals
- KanbanBoard: columns, tasks, draggedTask, modals
```

---

## API Endpoints (Supabase)

### Read Operations
```sql
-- Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ñ‹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
GET /rest/v1/workspace_projects?user_id=eq.{id}

-- Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð´Ð¾ÑÐºÐ¸ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°
GET /rest/v1/boards?project_id=eq.{id}

-- Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ ÐºÐ¾Ð»Ð¾Ð½ÐºÐ¸ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°
GET /rest/v1/board_columns?project_id=eq.{id}

-- Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°
GET /rest/v1/tasks?project_id=eq.{id}

-- Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ñ‡Ð»ÐµÐ½Ð¾Ð² ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹
GET /rest/v1/team_members?project_id=eq.{id}
```

### Write Operations
```sql
-- Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¾ÐµÐºÑ‚
INSERT INTO workspace_projects (user_id, name, description)

-- Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð´Ð¾ÑÐºÑƒ
INSERT INTO boards (project_id, name, description)

-- Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð·Ð°Ð´Ð°Ñ‡Ñƒ
INSERT INTO tasks (column_id, project_id, title, ...)

-- ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð·Ð°Ð´Ð°Ñ‡Ñƒ
UPDATE tasks SET column_id = {id} WHERE id = {id}

-- Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ð·Ð°Ð´Ð°Ñ‡Ñƒ
DELETE FROM tasks WHERE id = {id}

-- Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ñ‡Ð»ÐµÐ½Ð° ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹
INSERT INTO team_members (project_id, user_id, role)
```

---

## Error Handling

### Auth Errors
```typescript
try {
  const { error } = await supabase.auth.signInWithPassword(...)
  if (error) {
    // Show error message
    // Redirect to auth page
  }
} catch (err) {
  // Network error or client error
}
```

### Database Errors
```typescript
try {
  const { data, error } = await supabase
    .from("table")
    .select()
  
  if (error) {
    // Handle DB error
    // Log to console
    // Show user-friendly message
  }
} catch (err) {
  // Unexpected error
}
```

### Common Error Codes
```
23505  â†’ Duplicate entry
42P01  â†’ Table not found
42703  â†’ Column not found
22001  â†’ String too long
PGRST116 â†’ RLS violation
```

---

## Security

### Row Level Security
```sql
-- Each user can only see their own projects
CREATE POLICY "Users can view their own projects"
ON workspace_projects
FOR SELECT
USING (auth.uid() = user_id)

-- Team members can see project data
CREATE POLICY "Team members can see boards"
ON boards
FOR SELECT
USING (
  EXISTS (
    SELECT 1 FROM workspace_projects
    WHERE workspace_projects.id = boards.project_id
    AND (workspace_projects.user_id = auth.uid() OR ...)
  )
)
```

### Authentication
- Supabase Auth handles password hashing
- JWT tokens for session management
- Automatic token refresh

### Data Protection
- RLS policies on all tables
- User ID validation
- Role-based access control

---

## Performance Optimizations

### Frontend
```typescript
// Memoization for expensive operations
const projectCards = useMemo(() => [...], [projects])

// Debounced handlers
const debouncedSearch = useDebouncedCallback((query) => {...}, 300)

// Virtual scrolling for long lists (future)
<VirtualList items={tasks} />

// Lazy loading images
<img loading="lazy" />
```

### Database
```sql
-- Indexes on frequently queried columns
CREATE INDEX idx_workspace_projects_user_id
CREATE INDEX idx_team_members_project_id
CREATE INDEX idx_tasks_column_id

-- Efficient queries with select
SELECT * WHERE ... (with indexes)
```

### Network
```typescript
// Request deduplication
// Caching with React Query (future)
// Optimistic updates
```

---

## Scalability

### Current Limits
- Single user workspace
- No real-time updates (pull-based)
- In-memory state

### Future Improvements
- Infinite scroll for projects
- Pagination for tasks
- Real-time subscriptions (Supabase Realtime)
- Caching layer
- Background jobs for heavy operations

---

## Testing Strategy

```typescript
// Unit Tests
- Button handlers
- Form validation
- Data transformations

// Integration Tests
- Auth flow
- Project CRUD
- Task movements

// E2E Tests
- Full user workflows
- Drag & drop
- Team collaboration
```

---

## Deployment

### Build Process
```bash
npm run build
# Output: dist/ folder ready for deployment
```

### Environment Variables
```
VITE_SUPABASE_URL=https://...supabase.co
VITE_SUPABASE_KEY=...
```

### Hosting Options
- Vercel (recommended)
- GitHub Pages
- Netlify
- Self-hosted

---

## Monitoring & Logging

```typescript
// Error logging
console.error("Error creating task:", error)

// Success logging
console.log("Task created:", data)

// Supabase monitoring
- Check dashboard for query performance
- Monitor rate limits
- Track error rates
```

---

## Version Control

```
Git workflow:
main
â”œâ”€â”€ development
â”‚   â”œâ”€â”€ feature/workspace-kanban
â”‚   â”œâ”€â”€ feature/workspace-auth
â”‚   â””â”€â”€ feature/workspace-teams
â””â”€â”€ production
```

---

## Technology Stack

| Layer | Technology |
|-------|-----------|
| Frontend | React 18 + TypeScript |
| Styling | Tailwind CSS |
| Animations | Framer Motion |
| Routing | React Router v6 |
| State | Local + Context |
| Backend | Supabase (PostgreSQL) |
| Auth | Supabase Auth |
| Build | Vite |
| Package Manager | npm |

---

*Architecture v1.0 - Created 11 December 2025*
